# Cursor Rules for Credit Card App

## 项目技术栈
- **框架**: React Native 0.81.5 + Expo SDK 54
- **语言**: TypeScript (严格模式)
- **路由**: Expo Router (文件系统路由)
- **UI 库**: React Native Paper
- **样式**: NativeWind (Tailwind CSS)
- **状态管理**: Zustand
- **数据获取**: React Query (@tanstack/react-query)
- **国际化**: i18next + react-i18next
- **HTTP 客户端**: Axios

## 代码风格

### TypeScript
- 使用严格模式 (`strict: true`)
- 优先使用类型推断，必要时显式声明类型
- 使用 `interface` 定义对象类型，`type` 用于联合类型和工具类型
- 组件 Props 使用 `interface` 定义，命名格式：`ComponentNameProps`
- 导出类型时使用 `export type` 或 `export interface`

### React 组件
- 使用函数组件和 Hooks
- 组件文件使用 PascalCase 命名（如 `LoginScreen.tsx`）
- 组件导出使用命名导出：`export function ComponentName() {}`
- 优先使用 `const` 声明，必要时使用 `let`
- 使用 `React.useEffect` 或 `useEffect` 处理副作用
- 使用 `React.useState` 或 `useState` 管理本地状态

### 文件组织
- **组件**: `components/` 目录，按功能分类（如 `components/auth/`, `components/features/`）
- **页面**: `app/` 目录（Expo Router 约定）
- **状态管理**: `store/` 目录，使用 Zustand
- **服务/API**: `services/` 目录，按模块分类
- **Hooks**: `hooks/` 目录，自定义 Hooks 以 `use-` 开头
- **国际化**: `i18n/` 目录
- **常量**: `constants/` 目录
- **类型定义**: `types/` 目录或与相关文件同目录

### 命名约定
- **组件**: PascalCase (`LoginScreen`, `PhoneInput`)
- **文件**: 
  - 组件文件: PascalCase (`LoginScreen.tsx`)
  - 工具文件: kebab-case (`use-i18n.ts`, `request-encrypt.ts`)
  - 类型文件: kebab-case (`common.types.ts`)
- **变量/函数**: camelCase (`phoneNumber`, `handleGetVerificationCode`)
- **常量**: UPPER_SNAKE_CASE (`DEFAULT_COUNTRY`)
- **类型/接口**: PascalCase (`User`, `AuthState`, `LoginScreenProps`)

### 导入顺序
1. React 相关 (`react`, `react-native`)
2. 第三方库（按字母顺序）
3. Expo 相关
4. 项目内部导入（使用 `@/` 别名）
5. 类型导入（使用 `import type`）

示例：
```typescript
import React, { useState } from 'react';
import { View, Text, Alert } from 'react-native';
import { Button, useTheme } from 'react-native-paper';
import { useRouter } from 'expo-router';
import { useI18n } from '@/hooks/use-i18n';
import type { User } from '@/store/use-auth-store';
```

### 样式
- 优先使用 NativeWind (Tailwind CSS) 类名：`className="flex-1 p-4"`
- 复杂样式使用 `StyleSheet.create`
- 使用 React Native Paper 的 `useTheme` Hook 获取主题
- 响应式设计考虑不同屏幕尺寸

### 国际化
- 所有用户可见文本必须使用 i18n
- 使用 `useI18n` Hook 获取 `t` 函数
- 翻译 key 使用点号分隔的命名空间（如 `auth.phoneNumberRequired`）
- 语言文件位于 `i18n/locales/`
- 支持的语言：`en-US` , `zh-CN` , `zh-TW` 

### 状态管理
- 使用 Zustand 进行全局状态管理
- Store 文件命名：`use-{name}-store.ts`
- 使用 `persist` 中间件持久化需要的数据
- 本地状态优先使用 `useState`，只有需要跨组件共享时才使用 Store

### API 调用
- 使用 React Query 进行数据获取和缓存
- API 服务位于 `services/` 目录
- 使用自定义 Hook（如 `use-api-example.ts`）封装 React Query
- 错误处理要友好，显示用户可理解的错误信息

### 注释
- **所有代码注释和 Git commit 信息必须使用中文**
- 文件顶部使用 JSDoc 风格注释说明文件用途
- 复杂逻辑添加行内注释
- 函数/组件添加 JSDoc 注释说明参数和返回值

示例：
```typescript
/**
 * 登录页面
 * 手机号验证码登录
 */

/**
 * 验证手机号格式
 * @param phone 手机号字符串
 * @returns 是否为有效格式
 */
const validatePhoneNumber = (phone: string): boolean => {
  // 移除所有非数字字符
  const digitsOnly = phone.replace(/\D/g, '');
  return digitsOnly.length >= 6 && digitsOnly.length <= 15;
};
```

### 错误处理
- 使用 `try-catch` 处理异步操作
- 错误信息要用户友好，使用 i18n 翻译
- 使用 `console.error` 记录错误详情（开发环境）
- 使用 `Alert.alert` 显示用户提示

### 性能优化
- 使用 `React.memo` 优化组件渲染（必要时）
- 使用 `useMemo` 和 `useCallback` 优化计算和函数（必要时）
- 避免在渲染函数中创建新对象/数组
- 图片使用 `expo-image` 的 `Image` 组件

### 代码质量
- 遵循 ESLint 规则
- 使用 Prettier 格式化代码
- 提交前运行 `npm run lint` 和 `npm run format:check`
- 保持函数简洁，单一职责
- 避免深层嵌套，优先使用早期返回

## 特定库的使用

### React Native Paper
- 使用 `useTheme` Hook 获取主题
- 组件使用 Paper 提供的组件（`Button`, `Text`, `TextInput` 等）
- 主题配置在 `constants/paper-theme.ts`

### Expo Router
- 页面文件放在 `app/` 目录
- 使用 `useRouter` Hook 进行导航
- 路由参数通过 `useLocalSearchParams` 获取

### NativeWind
- 使用 `className` prop 应用 Tailwind 类
- 配置在 `tailwind.config.js`
- 支持响应式类名

## 禁止事项
- ❌ 不要使用 `any` 类型（除非绝对必要）
- ❌ 不要使用 `var`，使用 `const` 或 `let`
- ❌ 不要直接修改 state，使用不可变更新
- ❌ 不要在组件中直接使用硬编码的文本，必须使用 i18n
- ❌ 不要忽略 TypeScript 错误
- ❌ 不要提交未格式化的代码
- ❌ 不要创建不必要的文件或文档（如 README.md），除非明确要求

## 路径别名
- `@/*` 指向项目根目录
- 使用路径别名而不是相对路径（如 `@/components/auth/login-screen` 而不是 `../../components/auth/login-screen`）

## Git Commit
- Commit 信息使用中文
- 格式：`类型: 简短描述`
- 类型：`feat`, `fix`, `docs`, `style`, `refactor`, `test`, `chore`

## 开发工作流
1. 创建功能分支
2. 编写代码（遵循上述规范）
3. 运行 `npm run lint:fix` 修复 lint 问题
4. 运行 `npm run format` 格式化代码
5. 测试功能
6. 提交代码（使用中文 commit 信息）


